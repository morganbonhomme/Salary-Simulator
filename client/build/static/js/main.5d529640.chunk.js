(this.webpackJsonpclient=this.webpackJsonpclient||[]).push([[0],{40:function(e,t,a){e.exports=a(69)},45:function(e,t,a){},69:function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),s=a(22),o=a.n(s),l=(a(45),a(7)),c=a(18),i=a(15),u=a(39),m=a(16),d=a.n(m),p=a(1),h=a(20),b=a(5),v=a(6),g=a(9),f=a(8),y=a(3),E=function(e){return r.a.createElement("div",null,e.children)},N=function(e){var t,a=e.isAuthenticated,n=e.role,s=r.a.createElement(i.b,{className:"nav-item nav-link",to:"/log-in"},"Log in"),o=r.a.createElement(i.b,{className:"nav-item nav-link",to:"/logout"},"Log out"),l=r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("a",{className:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}," Compensation "),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement("a",{className:"dropdown-item",href:"/salary-calculator"},"Simulator"))),c=r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("a",{className:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}," Compensation "),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement(i.b,{className:"dropdown-item mb-0",to:"/"},"Simulator"),r.a.createElement("a",{className:"dropdown-item",href:"/users-information"},"Team overview"))),u=r.a.createElement("li",{className:"nav-item dropdown"},r.a.createElement("a",{className:"nav-link dropdown-toggle",href:"#",id:"navbarDropdown",role:"button","data-toggle":"dropdown","aria-haspopup":"true","aria-expanded":"false"}," Manage Organisation "),r.a.createElement("div",{className:"dropdown-menu","aria-labelledby":"navbarDropdown"},r.a.createElement("a",{className:"dropdown-item",href:"/settings/users"},"Users")));return a?"Admin"===n?t=r.a.createElement("div",{className:"navbar-nav "},c,u,o):"Team"===n&&(t=r.a.createElement("div",{className:"navbar-nav "},l,o)):t=r.a.createElement("div",{className:"navbar-nav"},s),r.a.createElement("nav",{className:"navbar navbar-expand-lg navbar-light bg-light mb-4 "},r.a.createElement(i.b,{className:"navbar-brand ml-4",to:"/"},"Dashboard"),r.a.createElement("button",{className:"navbar-toggler",type:"button","data-toggle":"collapse","data-target":"#navbarNavAltMarkup","aria-controls":"navbarNavAltMarkup","aria-expanded":"false","aria-label":"Toggle navigation"},r.a.createElement("span",{className:"navbar-toggler-icon"})),r.a.createElement("div",{className:"collapse navbar-collapse justify-content-end mr-4",id:"navbarNavAltMarkup"},t))},j=a(17),O=a(4),k=a.n(O),w=function(e){var t=Object(j.a)(new Set(e.choices)).map((function(e){return r.a.createElement("option",{key:e,value:e},e)}));return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",{className:"font-weight-bold",htmlFor:e.id},e.name),r.a.createElement("select",{className:"custom-select",id:e.id,onChange:e.onChange,value:e.selected},t))},C=function(e){var t,a,n,s;return e.min&&e.max&&(t=r.a.createElement("input",{type:"range",className:"custom-range ",min:e.min,max:e.max,step:"0.01",id:"masterRange",value:e.inputValue,onInput:e.rangeChanged,onChange:e.rangeChanged}),a=r.a.createElement("input",{type:"text",readOnly:!0,className:"form-control-plaintext text-right",id:"minRange",value:e.min}),n=r.a.createElement("input",{type:"text",readOnly:!0,className:"form-control-plaintext",id:"maxRange",value:e.max}),e.inputValue&&(s=r.a.createElement("input",{type:"text",readOnly:!0,className:"form-control-plaintext w-25 text-center mx-auto font-weight-bolder text-primary",id:"actualValue",value:e.inputValue}))),r.a.createElement("div",{className:"form-group"},r.a.createElement(w,{onChange:e.onChange,name:e.name,key:e.id,id:e.id,choices:e.choices,selected:e.selected}),r.a.createElement("div",{className:"container-fluid"},r.a.createElement("div",{className:"row justify-content-center "},r.a.createElement("div",{className:"col"},s)),r.a.createElement("div",{className:"row justify-content-center "},r.a.createElement("div",{className:"col-4"},a),r.a.createElement("div",{className:"col my-auto"},t),r.a.createElement("div",{className:"col-4"},n))))};function x(e,t){return e.country.filter((function(e){return e.name===t?e:null})).map((function(e){return e.area}))}function S(e,t){return Object(j.a)(new Set(e[t].map((function(e){return e.name}))))}function A(e,t){return e.master.filter((function(e){return e.name===t?e:null}))[0].factor}function V(e,t,a){return e[t].filter((function(e){return e.name===a?e:null}))[0].factor}function M(e,t,a){var n=V(e,"job",t.job)*V(e,"seniority",t.seniority)*V(e,"contract",t.contract)*function(e,t,a){return e.country.filter((function(e){return e.area===a&&e.name===t?e:null}))[0].factor}(e,t.country,t.city)*parseFloat(a)*(100/60/100);return 1e3*Math.round(n/1e3)}var D="https://api-dot-modular-source-287611.nw.r.appspot.com",U=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={selectedUser:"",selectedSalary:"",redirect:!1,loading:!1},e.saveSalary=function(t,a,n,r){var s={userID:t,salary:a,factors:n},o={headers:{Authorization:"Bearer ".concat(r)}};k.a.post("".concat(D,"/user/savesalary"),s,o).then((function(t){return e.setState(Object(p.a)(Object(p.a)({},e.state),{},{redirect:!0}))})).catch((function(e){return console.log(e)}))},e.selectedUserChangeHandler=function(t){var a=t.target.value;e.setState(Object(p.a)(Object(p.a)({},e.state),{},{selectedUser:a}))},e.saveSalaryHandler=function(){var t=M(e.props.data,e.props.currentValues,e.props.rangeFactor),a=e.props.selectedUser?e.props.selectedUser:e.state.selectedUser;e.saveSalary(a,1e3*Math.round(t/1e3),e.props.currentValues,e.props.token),e.setState(Object(p.a)(Object(p.a)({},e.state),{},{selectedSalary:t}))},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=M(this.props.data,this.props.currentValues,this.props.rangeFactor);this.setState(Object(p.a)(Object(p.a)({},this.state),{},{selectedUser:this.props.selectedUser?this.props.selectedUser:"",selectedSalary:Math.round(e)}))}},{key:"render",value:function(){var e=this,t=this.props.users.map((function(t){return e.props.selectedUser===t.email?r.a.createElement("option",{key:t.email,value:t.email,selected:!0},"".concat(t.firstName," ").concat(t.lastName)):r.a.createElement("option",{key:t.email,value:t.email},"".concat(t.firstName," ").concat(t.lastName))}));this.props.selectedUser;var a,n,s=this.props.users.filter((function(t){return e.props.selectedUser===t.email?t:null}));return s.length>0&&(a=r.a.createElement("p",null," ","".concat(s[0].firstName," ").concat(s[0].lastName)," ")),this.state.redirect&&(n=r.a.createElement(y.a,{to:"/users-information"})),r.a.createElement("div",{className:"container-fluid p-3 mb-5 bg-light border rounded "},n,r.a.createElement("div",{className:"row justify-content-end"},r.a.createElement("div",{className:"col-12 text-center"},"Save this salary for :"),r.a.createElement("div",{className:"col-12 font-weight-bold text-center"},a),r.a.createElement("div",{className:"col-12 text-center"},r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:this.saveSalaryHandler},"Save"))))}}]),a}(n.Component),I=function(e){var t=M(e.data,e.currentValues,e.rangeFactor),a=new Intl.NumberFormat("fr",{style:"currency",minimumFractionDigits:0,currency:"EUR"}).format(t.toFixed());return r.a.createElement("div",{className:"container-fluid bg-success"},r.a.createElement("div",{className:"row justify-content-center "},r.a.createElement("div",{className:"col mt-4 text-center"},r.a.createElement("p",{className:"text-white font-weight-bold"},r.a.createElement("span",{className:"h2"},a)," / year (before tax)"))))},T=function(){return r.a.createElement("div",{className:"text-center text-secondary mt-5 mb-5 pt-5"},r.a.createElement("div",{className:"spinner-border",role:"status"},r.a.createElement("span",{className:"sr-only"},"Loading...")))},H=function(e){var t;e.salary&&(t=r.a.createElement("p",{className:"font-weight-bolder my-1"},new Intl.NumberFormat("fr",{style:"currency",minimumFractionDigits:0,currency:"EUR"}).format(e.salary.toFixed())));var a=r.a.createElement("p",{className:"my-1"},"\n    ".concat(e.values.job," // \n    ").concat(e.values.country," // \n    ").concat(e.values.city," // \n    ").concat(e.values.seniority," // \n    ").concat(e.values.masterRange," // \n    ").concat(e.values.masterValue," // \n    ").concat(e.values.contract,"\n  "));return r.a.createElement("div",{className:"container-fluid mb-3 bg-light border rounded "},r.a.createElement("div",{className:"row justify-content-center "},r.a.createElement("div",{className:"col my-2 text-center"},r.a.createElement("p",{className:"my-1"}," Your actual salary (before tax): "),t,a)))},R=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={data:{},cities:{},values:{job:null,masterRange:null,masterValue:.85,seniority:null,contract:null,country:null,city:null},defaultValues:{},loading:!0,loadingUserData:!0,users:[],selectedUser:null,authenticatedEmployeeSalary:null,noData:null},e.fetchUserData=function(t,a){var n={headers:{Authorization:"Bearer ".concat(t)}};return k.a.get("".concat(D,"/user/getuser/").concat(a),n).then((function(t){var a=Object(p.a)({},e.state.values),n=!1;""===t.data.body.job?(a.job=e.state.defaultValues.job,n=!0):a.job=t.data.body.job,""===t.data.body.masterRange?a.masterRange=e.state.defaultValues.masterRange:a.masterRange=t.data.body.masterRange,0===t.data.body.masterValue?a.masterValue=e.state.defaultValues.masterValue:a.masterValue=t.data.body.masterValue,""===t.data.body.seniority?a.seniority=e.state.defaultValues.seniority:a.seniority=t.data.body.seniority,""===t.data.body.contract?a.contract=e.state.defaultValues.contract:a.contract=t.data.body.contract,""===t.data.body.country?a.country=e.state.defaultValues.country:a.country=t.data.body.country,""===t.data.body.city?a.city=e.state.defaultValues.city:a.city=t.data.body.city,e.setState(Object(p.a)(Object(p.a)({},e.state),{},{values:a,authenticatedEmployeeSalary:t.data.body.salary,loadingUserData:!1,noData:n}))})).catch((function(e){return console.log("error",e)}))},e.fetchData=function(t){return k.a.get("".concat(D,"/simulator"),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){var a=Object(p.a)({},e.state.values);a.job=e.props.location.state?""===e.props.location.state.job?t.data.body.job[0].name:e.props.location.state.job:t.data.body.job[0].name,a.masterRange=e.props.location.state?""===e.props.location.state.masterRange?t.data.body.master[0].name:e.props.location.state.masterRange:t.data.body.master[0].name,a.masterValue=e.props.location.state?0===e.props.location.state.masterValue?.85:e.props.location.state.masterValue:.85,a.seniority=e.props.location.state?""===e.props.location.state.seniority?t.data.body.seniority[0].name:e.props.location.state.seniority:t.data.body.seniority[0].name,a.contract=e.props.location.state?""===e.props.location.state.contract?t.data.body.contract[0].name:e.props.location.state.contract:t.data.body.contract[0].name,a.country=e.props.location.state?""===e.props.location.state.country?Object(j.a)(new Set(t.data.body.country.map((function(e){return e.name})))).sort()[0]:e.props.location.state.country:Object(j.a)(new Set(t.data.body.country.map((function(e){return e.name})))).sort()[0],a.city=e.props.location.state?""===e.props.location.state.city?"All":e.props.location.state.city:"All",e.setState(Object(p.a)(Object(p.a)({},e.state),{},{data:t.data.body,values:a,defaultValues:a,loading:!1}))})).catch((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{loading:!1})),console.log(t.response.data.message)}))},e.fetchUsers=function(t){return k.a.get("".concat(D,"/user/getusers"),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{users:t.data.body}))})).catch((function(e){return console.log(e.response.data.message)}))},e.selectedValueChangeHandler=function(t,a){var n=Object(p.a)({},e.state.values);if(n[a]=t.target.value,"country"===a){var r=x(e.state.data,t.target.value);n.city=r[0]}if("masterValue"===a&&(n.masterValue=t.target.value),"masterRange"===a){var s=A(e.state.data,t.target.value)[0];n.masterValue=s}e.setState(Object(p.a)(Object(p.a)({},e.state),{},{values:n}))},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.props.token){e.next=10;break}return e.next=3,this.fetchData(this.props.token);case 3:return e.next=5,this.fetchUsers(this.props.token);case 5:if(void 0!==this.props.location.state){e.next=8;break}return e.next=8,this.fetchUserData(this.props.token,this.props.userID);case 8:e.next=11;break;case 10:this.setState(Object(p.a)(Object(p.a)({},this.state),{},{loading:!1}));case 11:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"render",value:function(){var e,t,a,n,s,o,l,c=this,i=this.state.data;if(i.job&&(e=r.a.createElement(w,{onChange:function(e){return c.selectedValueChangeHandler(e,"job")},name:"Job",key:"job",id:"job",choices:S(i,"job"),selected:this.state.values.job})),i.country&&(t=r.a.createElement(w,{onChange:function(e){return c.selectedValueChangeHandler(e,"country")},name:"Country",key:"country",id:"country",choices:S(i,"country").sort(),selected:this.state.values.country}),a=r.a.createElement(w,{onChange:function(e){return c.selectedValueChangeHandler(e,"city")},name:"City or Area",key:"city",id:"city",choices:x(i,this.state.values.country),selected:this.state.values.city})),i.seniority&&(n=r.a.createElement(w,{onChange:function(e){return c.selectedValueChangeHandler(e,"seniority")},name:"Seniority",key:"seniority",id:"seniority",choices:S(i,"seniority"),selected:this.state.values.seniority})),i.master){var u=A(i,this.state.values.masterRange);s=r.a.createElement(C,{rangeChanged:function(e){return c.selectedValueChangeHandler(e,"masterValue")},inputValue:this.state.values.masterValue,onChange:function(e){return c.selectedValueChangeHandler(e,"masterRange")},name:"Master level of the role",key:"master",id:"master",choices:S(i,"master"),min:u[0],max:u[1],selected:this.state.values.masterRange})}i.contract&&(o=r.a.createElement(w,{onChange:function(e){return c.selectedValueChangeHandler(e,"contract")},name:"Contract",key:"contract",id:"contract",choices:S(i,"contract"),selected:this.state.values.contract})),this.state.values.job&&(l=r.a.createElement(I,{data:this.state.data,currentValues:this.state.values,rangeFactor:this.state.values.masterValue}," "));var m,d,p,h=r.a.createElement("div",{className:"shadow p-3 mb-5 bg-white rounded"},e,t,a,n,s,o,l);return this.state.values.job&&(m=r.a.createElement(U,{token:this.props.token,users:this.state.users,data:this.state.data,currentValues:this.state.values,rangeFactor:this.state.values.masterValue,selectedUser:this.props.location.state?this.props.location.state.email:null})),d=null===this.state.noData?r.a.createElement(T,null):!0===this.state.noData?r.a.createElement("div",{className:"container-fluid mb-3 bg-light border rounded "},r.a.createElement("div",{className:"row justify-content-center "},r.a.createElement("div",{className:"col my-2 text-center"},r.a.createElement("p",{className:"my-1"}," Your salary has not been defined yet ")))):r.a.createElement(H,{values:this.state.values,salary:this.state.authenticatedEmployeeSalary}),"Admin"===this.props.role?p=void 0!==this.props.location.state?r.a.createElement(E,null,h,m):r.a.createElement(E,null,d,h):"Team"===this.props.role&&(p=r.a.createElement(E,null,d,h)),this.state.loading&&this.state.loadingUserData&&(p=r.a.createElement(T,null)),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col col-lg-8"},p)))}}]),a}(n.Component),L=Object(l.b)((function(e){return{token:e.auth.token,userID:e.auth.userID,role:e.auth.role}}))(R),z=function(e){var t=null;switch(e.elementType){case"input":default:t=r.a.createElement("input",Object.assign({className:"form-control"},e.elementConfig,{value:e.value,onChange:e.onChange}))}return r.a.createElement("div",{className:"form-group"},r.a.createElement("label",null,e.label),t,r.a.createElement("div",{className:"text-danger"},e.errorMessage))},F=function(e){return r.a.createElement("div",{className:"alert ".concat(e.className," mt-4"),role:"alert"},e.message,e.link)},_=function(){return r.a.createElement("div",null,r.a.createElement("div",{className:"alert alert-danger mt-4"},"Forbidden access You need to be an admin to access this page."))},P=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={user:{firstName:{elementType:"input",elementConfig:{type:"text"},value:"",label:"First name",errorMessage:""},lastName:{elementType:"input",elementConfig:{type:"text"},value:"",label:"Last name",errorMessage:""},email:{elementType:"input",elementConfig:{type:"email"},value:"",label:"Email",errorMessage:""}},role:"Team",serverError:"",posted:!1},e.checkValidity=function(){var t=!0,a=Object(p.a)({},e.state.user),n=Object(p.a)({},a.firstName);n.errorMessage="",""===e.state.user.firstName.value.trim()&&(n.errorMessage="First name is required",t=!1);var r=Object(p.a)({},a.lastName);r.errorMessage="",""===e.state.user.lastName.value.trim()&&(r.errorMessage="Last name is required",t=!1);var s=Object(p.a)({},a.email);s.errorMessage="";return console.log(),/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e.state.user.email.value.trim())||(s.errorMessage="Email is invalid",t=!1),a.firstName=n,a.lastName=r,a.email=s,e.setState(Object(p.a)(Object(p.a)({},e.state),{},{user:a})),t},e.createNewUserHandler=function(t){if(t.preventDefault(),e.checkValidity()){var a={firstName:e.state.user.firstName.value,lastName:e.state.user.lastName.value,email:e.state.user.email.value.toLowerCase(),role:e.state.role};k.a.post("".concat(D,"/user/create"),a).then((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{posted:!0,serverError:""}))})).catch((function(t){var a=t.response.data.message.split("Error: ");e.setState(Object(p.a)(Object(p.a)({},e.state),{},{posted:!1,serverError:a.join("")}))}))}},e.selectedValueChangeHandler=function(t){console.log(t.target.value),e.setState(Object(p.a)(Object(p.a)({},e.state),{},{role:t.target.value}))},e.inputChangedHandler=function(t,a){var n=Object(p.a)({},e.state.user),r=Object(p.a)({},n[a]);r.value=t.target.value,n[a]=r,e.setState(Object(p.a)(Object(p.a)({},e.state),{},{user:n}))},e}return Object(v.a)(a,[{key:"render",value:function(){var e=this,t=[];for(var a in this.state.user)t.push({id:a,config:this.state.user[a]});var n,s,o=t.map((function(t){return r.a.createElement(z,{elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,key:t.id,label:t.config.label,onChange:function(a){return e.inputChangedHandler(a,t.id)},errorMessage:t.config.errorMessage})})),l=r.a.createElement(w,{choices:["Team","Admin"],key:"role",id:"role",name:"Role",onChange:this.selectedValueChangeHandler}),c=r.a.createElement("button",{onClick:this.createNewUserHandler,type:"submit",className:"btn btn-primary"},"Create");this.state.posted?(s=r.a.createElement("a",{href:"/settings/users",className:"btn btn-primary",role:"button","aria-pressed":"true"},"Go back"),c=null,n=r.a.createElement(F,{className:"alert-success",message:"Email sent"})):""!==this.state.serverError&&(n=r.a.createElement(F,{className:"alert-danger",message:this.state.serverError}));var i=r.a.createElement("form",{className:"shadow p-3 mb-5 bg-white rounded"},o,l,c,n,s);return"Team"===this.props.role&&(i=r.a.createElement(_,null)),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col col-lg-6"},r.a.createElement("h2",null,"Create User"),i)))}}]),a}(n.Component),B=Object(l.b)((function(e){return{token:e.auth.token,userID:e.auth.userID,role:e.auth.role}}))(P),G=function(e,t,a){return{type:"LOGIN_SUCCESS",userID:e,token:t,role:a}},$=function(){return localStorage.removeItem("token"),localStorage.removeItem("userID"),localStorage.removeItem("role"),{type:"LOGOUT"}},q=function(e){return function(t){t({type:"LOGIN_START"}),k.a.post("".concat(D,"/user/login"),e).then((function(a){localStorage.setItem("token",a.data.body.token),localStorage.setItem("userID",e.email),localStorage.setItem("role",a.data.body.role),t(G(e.email,a.data.body.token,a.data.body.role))})).catch((function(e){console.log(e.response.data.message),t(function(e){return{type:"LOGIN_FAIL",error:e}}(e.response.data.message))}))}},J=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={user:{email:{elementType:"input",elementConfig:{type:"email"},value:"",label:"Email",errorMessage:""},password:{elementType:"input",elementConfig:{type:"password"},value:"",label:"Password",errorMessage:""}},serverError:""},e.inputChangedHandler=function(t,a){var n=Object(p.a)({},e.state.user),r=Object(p.a)({},n[a]);r.value=t.target.value,n[a]=r,e.setState(Object(p.a)(Object(p.a)({},e.state),{},{user:n}))},e.checkValidity=function(){var t=!0,a=Object(p.a)({},e.state.user),n=Object(p.a)({},a.email);n.errorMessage="";/[a-z0-9!#$%&'*+/=?^_`{|}~-]+(?:\.[a-z0-9!#$%&'*+/=?^_`{|}~-]+)*@(?:[a-z0-9](?:[a-z0-9-]*[a-z0-9])?\.)+[a-z0-9](?:[a-z0-9-]*[a-z0-9])?/.test(e.state.user.email.value.trim())||(n.errorMessage="Email is invalid",t=!1);var r=Object(p.a)({},a.password);return r.errorMessage="",""===e.state.user.password.value.trim()&&(r.errorMessage="Password is required",t=!1),a.email=n,a.password=r,e.setState(Object(p.a)(Object(p.a)({},e.state),{},{user:a})),t},e.loginUserHandler=function(t){if(t.preventDefault(),e.checkValidity()){var a={password:e.state.user.password.value,email:e.state.user.email.value.toLowerCase()};e.props.onLogin(a)}},e}return Object(v.a)(a,[{key:"render",value:function(){var e,t=this;this.props.isAuthenticated&&(e=r.a.createElement(y.a,{to:"../../salary-calculator"}));var a=[];for(var n in this.state.user)a.push({id:n,config:this.state.user[n]});var s,o=a.map((function(e){return r.a.createElement(z,{elementType:e.config.elementType,elementConfig:e.config.elementConfig,value:e.config.value,key:e.id,label:e.config.label,onChange:function(a){return t.inputChangedHandler(a,e.id)},errorMessage:e.config.errorMessage})}));return this.props.loading&&(o=r.a.createElement(T,null)),this.props.error&&(s=r.a.createElement(F,{className:"alert-danger",message:this.props.error})),r.a.createElement("div",{className:"container"},e,r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col col-lg-6"},r.a.createElement("form",{className:"shadow p-3 mb-5 bg-white rounded"},o,r.a.createElement("button",{onClick:this.loginUserHandler,type:"submit",className:"btn btn-primary"},"Log in"),s))))}}]),a}(n.Component),W=Object(l.b)((function(e){return{loading:e.auth.loading,error:e.auth.error,isAuthenticated:null!==e.auth.token}}),(function(e){return{onLogin:function(t){return e(q(t))}}}))(J),Y=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){return Object(b.a)(this,a),t.apply(this,arguments)}return Object(v.a)(a,[{key:"componentDidMount",value:function(){this.props.onLogout()}},{key:"render",value:function(){return r.a.createElement(y.a,{to:"/"})}}]),a}(n.Component),X=Object(l.b)(null,(function(e){return{onLogout:function(){return e($())}}}))(Y),K=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,isTokenValid:null,email:null,posted:!1,alert:!1,redirect:!1,serverError:"",user:{password:{elementType:"input",elementConfig:{type:"password"},value:"",label:"Password",errorMessage:""},confirmPassword:{elementType:"input",elementConfig:{type:"password"},value:"",label:"Confirm password",errorMessage:""}}},e.inputChangedHandler=function(t,a){var n=Object(p.a)({},e.state.user),r=Object(p.a)({},n[a]);r.value=t.target.value,n[a]=r,e.setState(Object(p.a)(Object(p.a)({},e.state),{},{user:n}))},e.checkValidity=function(){var t=!0,a=Object(p.a)({},e.state.user),n=Object(p.a)({},a.password);n.errorMessage="",""===e.state.user.password.value.trim()?(n.errorMessage="Password is required",t=!1):e.state.user.password.value.trim().match(/^(?=.*[0-9])(?=.*[!@#$%^&*])[a-zA-Z0-9!@#$%^&*]{8,20}$/)||(n.errorMessage="Password must be between 8 to 20 characters with at least one numeric digit and one special character",t=!1);var r=Object(p.a)({},a.confirmPassword);return r.errorMessage="",e.state.user.password.value!==e.state.user.confirmPassword.value&&(r.errorMessage="Passwords do not match",t=!1),a.password=n,a.confirmPassword=r,e.setState(Object(p.a)(Object(p.a)({},e.state),{},{user:a})),t},e.updatePassword=function(t){if(t.preventDefault(),e.checkValidity()){var a=e.props.match.params.token,n={email:e.state.email,password:e.state.user.password.value};k.a.post("".concat(D,"/user/confirmation/").concat(a),n).then((function(t){e.props.onLogin(n),e.setState(Object(p.a)(Object(p.a)({},e.state),{},{posted:!0,serverError:""})),e.props.history.push({pathname:"../../salary-calculator"})})).catch((function(t){var a=t.response.data.message.split("Error: ");e.setState(Object(p.a)(Object(p.a)({},e.state),{},{posted:!1,serverError:a.join("")}))}))}},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=this,t=this.props.match.params.token;console.log("".concat(D,"/user/confirmation/").concat(t)),k.a.get("".concat(D,"/user/confirmation/").concat(t)).then((function(t){console.log("res",t),e.setState(Object(p.a)(Object(p.a)({},e.state),{},{loading:!1,isTokenValid:!0,email:t.data.email}))})).catch((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{loading:!1,isTokenValid:!1})),console.log(t)}))}},{key:"render",value:function(){var e=this,t=[];for(var a in this.state.user)t.push({id:a,config:this.state.user[a]});var n,s,o=t.map((function(t){return r.a.createElement(z,{elementType:t.config.elementType,elementConfig:t.config.elementConfig,value:t.config.value,key:t.id,label:t.config.label,onChange:function(a){return e.inputChangedHandler(a,t.id)},errorMessage:t.config.errorMessage})}));""!==this.state.serverError&&(n=r.a.createElement(F,{className:"alert-danger",message:this.state.serverError}));var l=r.a.createElement("button",{onClick:this.updatePassword,type:"submit",className:"btn btn-primary"},"Create password");return this.state.loading?(s=r.a.createElement(T,null),o=r.a.createElement("p",null),l=r.a.createElement("p",null)):this.state.isTokenValid?s=r.a.createElement("p",null," Please choose your password :"):(s=r.a.createElement("p",null," This link is expired."),o=r.a.createElement("p",null),l=r.a.createElement("p",null)),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col col-lg-6"},r.a.createElement("form",{className:"shadow p-3 mb-5 bg-white rounded"},s,o,l,n))))}}]),a}(n.Component),Z=Object(l.b)(null,(function(e){return{onLogin:function(t){return e(q(t))}}}))(K),Q=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={employees:{},selectedUser:null,loading:!0},e.fetchUsers=function(t){return k.a.get("".concat(D,"/user/getusers"),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{employees:t.data.body})),console.log("fetching User done and updated state")})).catch((function(t){console.log(t.response.data.message),e.setState(Object(p.a)({},e.state))}))},e.redirectWithInfoHandler=function(t){e.props.history.push({pathname:"../salary-calculator",state:t})},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===this.props.token){e.next=6;break}return console.log("Component did Mount - fetch users start"),e.next=4,this.fetchUsers(this.props.token);case 4:this.setState(Object(p.a)(Object(p.a)({},this.state),{},{loading:!1})),console.log("page stop load");case 6:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){e.token!==this.props.token&&this.fetchUsers(this.props.token)}},{key:"render",value:function(){var e,t=this,a=[];"Admin"===this.props.role&&(e=r.a.createElement("th",{className:"text-center",scope:"col"},"Edit")),this.state.employees&&(console.log("render employees in the Dom"),Object.values(this.state.employees).map((function(e){var n=r.a.createElement("tr",{key:e.email},r.a.createElement("td",{className:"align-middle"},"".concat(e.firstName," ").concat(e.lastName)),r.a.createElement("td",{className:"align-middle text-center"},0===e.salary?"":new Intl.NumberFormat("fr",{style:"currency",minimumFractionDigits:0,currency:"EUR"}).format(e.salary.toFixed())),r.a.createElement("td",{className:"align-middle text-center"},e.job),r.a.createElement("td",{className:"align-middle text-center"},""===e.country?"":"".concat(e.country,", ").concat(e.city)),r.a.createElement("td",{className:"align-middle text-center"},e.seniority),r.a.createElement("td",{className:"align-middle text-center"},""===e.masterRange?"":"".concat(e.masterRange," - ").concat(e.masterValue)),r.a.createElement("td",{className:"align-middle text-center"},e.contract),r.a.createElement("td",{className:"align-middle text-center"},r.a.createElement("button",{onClick:function(){return t.redirectWithInfoHandler({job:e.job,masterRange:e.masterRange,masterValue:e.masterValue,seniority:e.seniority,contract:e.contract,country:e.country,city:e.city,email:e.email})},type:"button",className:"btn btn-warning"},"Edit")));a.push(n)})));var n=r.a.createElement(E,null,r.a.createElement("table",{className:"table table-striped table-borderless table-sm table-responsive"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"text-center",scope:"col"},"Name"),r.a.createElement("th",{className:"text-center",scope:"col"},"Salary"),r.a.createElement("th",{className:"text-center",scope:"col"},"Job"),r.a.createElement("th",{className:"text-center",scope:"col"},"Localisation"),r.a.createElement("th",{className:"text-center",scope:"col"},"Seniority"),r.a.createElement("th",{className:"text-center",scope:"col"},"Master level"),r.a.createElement("th",{className:"text-center",scope:"col"},"Contract"),e)),r.a.createElement("tbody",null,a)));return this.state.loading&&(console.log("page is loading"),n=r.a.createElement(T,null)),"Team"===this.props.role&&(n=r.a.createElement(_,null)),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-auto"},r.a.createElement("h2",null," Team's wage "),n)))}}]),a}(n.Component),ee=Object(l.b)((function(e){return{token:e.auth.token,userID:e.auth.userID,role:e.auth.role}}))(Q),te=function(e){var t;switch(e.isActive){case!0:t=r.a.createElement("span",null," Active ");break;case!1:t=r.a.createElement("button",{type:"button",className:"btn btn-primary",onClick:e.onClick},"Resend invit");break;default:t=r.a.createElement("p",null," No information ")}return t},ae=function(e){var t,a=r.a.createElement(E,null,r.a.createElement("button",{type:"button",className:"btn btn-warning mr-3","data-dismiss":"modal"},"Cancel"),r.a.createElement("button",{onClick:e.onClick,type:"submit",className:"btn btn-danger"},"Remove"));return"typingError"===e.removeAlert&&(t=r.a.createElement("div",{className:"text-danger mb-3"},"  You did not type 'REMOVE' correctly. Try again. ")),"success"===e.removeAlert&&(t=r.a.createElement("div",{className:"text-success mb-3"}," User removed "),a=r.a.createElement("button",{type:"button",onClick:e.closeModal,className:"btn btn-secondary","data-dismiss":"modal"},"OK")),r.a.createElement(E,null,r.a.createElement("button",{type:"button",className:"btn btn-danger","data-toggle":"modal","data-target":"#delete"},"Remove"),r.a.createElement("div",{className:"modal fade",id:"delete","data-backdrop":"static",tabIndex:"-1","aria-labelledby":"deleteLabel","aria-hidden":"true"},r.a.createElement("div",{className:"modal-dialog"},r.a.createElement("div",{className:"modal-content"},r.a.createElement("div",{className:"modal-header"},r.a.createElement("h5",{className:"modal-title",id:"exampleModalLabel"},"Remove ".concat(e.name," ?")),r.a.createElement("button",{type:"button",onClick:e.closeModal,className:"close","data-dismiss":"modal","aria-label":"Close"},r.a.createElement("span",{"aria-hidden":"true"},"\xd7"))),r.a.createElement("div",{className:"modal-body"},r.a.createElement("p",null," Are you sure you want to remove ",r.a.createElement("span",{className:"font-weight-bold"},e.name)," from the dashboard ? If so, type REMOVE :  "),r.a.createElement("form",null,r.a.createElement("div",{className:"form-group"},r.a.createElement("input",{onChange:e.onChange,value:e.value,className:"form-control"})),t,a))))))},ne=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={loading:!0,employees:null,removeValue:"",removeAlert:null},e.fetchUsers=function(t){k.a.get("".concat(D,"/user/getusers"),{headers:{Authorization:"Bearer ".concat(t)}}).then((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{employees:t.data.body,loading:!1}))})).catch((function(t){console.log(t.response.data.message),e.setState(Object(p.a)(Object(p.a)({},e.state),{},{loading:!1}))}))},e.redirectCreateUserHandler=function(){e.props.history.push({pathname:"/create-user"})},e.sendMailHandler=function(t,a){var n={email:a},r={headers:{Authorization:"Bearer ".concat(e.props.token)}};k.a.post("".concat(D,"/user/send-mail"),n,r).then((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{mailSent:!0}))})).catch((function(e){console.log(e.response.data.message)}))},e.closeAlertMailHandler=function(){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{mailSent:!1}))},e.changeRoleHandler=function(e,t,a){var n={role:e.target.value,userID:t},r={headers:{Authorization:"Bearer ".concat(a)}};k.a.post("".concat(D,"/user/saverole"),n,r).then((function(e){return console.log(e)})).catch((function(e){return console.log(e)}))},e.onChangeHandler=function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{removeValue:t.target.value}))},e.checkRemoveValidity=function(e){return"REMOVE"===e},e.removeUserHandler=function(t,a,n){if(t.preventDefault(),e.checkRemoveValidity(e.state.removeValue)){var r={userID:a},s={headers:{Authorization:"Bearer ".concat(n)}};k.a.post("".concat(D,"/user/delete"),r,s).then((function(t){e.setState(Object(p.a)(Object(p.a)({},e.state),{},{removeAlert:"success"}))})).catch((function(e){return console.log(e)}))}else e.setState(Object(p.a)(Object(p.a)({},e.state),{},{removeAlert:"typingError"}))},e.closeModalHandler=function(){"success"===e.state.removeAlert?window.location.reload(!1):console.log("not")},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){null!==this.props.token&&this.fetchUsers(this.props.token)}},{key:"componentDidUpdate",value:function(e,t){e.token!==this.props.token&&this.fetchUsers(this.props.token)}},{key:"render",value:function(){var e,t=this,a=[];this.state.mailSent&&(e=r.a.createElement("div",{class:"alert alert-success alert-dismissible fade show",role:"alert"},"Mail sent",r.a.createElement("button",{type:"button",class:"close","data-dismiss":"alert","aria-label":"Close",onClick:this.closeAlertMailHandler},r.a.createElement("span",{"aria-hidden":"true"},"\xd7")))),this.state.employees&&Object.values(this.state.employees).map((function(e){var n;n=e.email===t.props.userID?r.a.createElement("tr",{key:e.email},r.a.createElement("td",{className:"align-middle"},"".concat(e.firstName," ").concat(e.lastName)),r.a.createElement("td",{className:"align-middle text-center"},r.a.createElement("select",{className:"custom-select",name:"role",id:"role",disabled:!0},r.a.createElement("option",null," ",e.role," "))),r.a.createElement("td",{className:"align-middle text-center"},r.a.createElement(te,{isActive:e.active,onClick:function(a,n){return t.sendMailHandler(a,e.email)}})),r.a.createElement("td",null)):r.a.createElement("tr",{key:e.email},r.a.createElement("td",{className:"align-middle"},"".concat(e.firstName," ").concat(e.lastName)),r.a.createElement("td",{className:"align-middle text-center"},r.a.createElement("select",{className:"custom-select",name:"role",id:"role",defaultValue:e.role,onChange:function(a){return t.changeRoleHandler(a,e.email,t.props.token)}},r.a.createElement("option",{value:"Team"},"Team"),r.a.createElement("option",{value:"Admin"},"Admin"))),r.a.createElement("td",{className:"align-middle text-center"},r.a.createElement(te,{isActive:e.active,onClick:function(a,n){return t.sendMailHandler(a,e.email)}})),r.a.createElement("td",{className:"align-middle text-center"},r.a.createElement(ae,{name:"".concat(e.firstName," ").concat(e.lastName),value:t.state.removeValue,onChange:t.onChangeHandler,removeAlert:t.state.removeAlert,onClick:function(a){return t.removeUserHandler(a,e.email,t.props.token)},closeModal:t.closeModalHandler}))),a.push(n)}));var n=r.a.createElement(E,null,e,r.a.createElement("table",{className:"table table-responsive table-striped table-borderless"},r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("th",{className:"text-center",scope:"col"},"Name"),r.a.createElement("th",{className:"text-center",scope:"col"},"Role"),r.a.createElement("th",{className:"text-center",scope:"col"},"Active"),r.a.createElement("th",{className:"text-center",scope:"col"},"Delete"))),r.a.createElement("tbody",null,a)),r.a.createElement("button",{onClick:this.redirectCreateUserHandler,className:"btn btn-primary"}," Add user "));return this.state.loading&&(n=r.a.createElement(T,null)),"Team"===this.props.role&&(n=r.a.createElement(_,null)),r.a.createElement("div",{className:"container"},r.a.createElement("div",{className:"row justify-content-center"},r.a.createElement("div",{className:"col-12 col-md-auto mx-auto"},r.a.createElement("h2",null," Users settings "),n)))}}]),a}(n.Component),re=Object(l.b)((function(e){return{token:e.auth.token,userID:e.auth.userID,role:e.auth.role}}))(ne),se=function(){return r.a.createElement("div",null,r.a.createElement("h1",{className:"text-center"},"Error 404"),r.a.createElement("h2",{className:"text-center"},"This page does not exist"))},oe=function(e){Object(g.a)(a,e);var t=Object(f.a)(a);function a(){var e;Object(b.a)(this,a);for(var n=arguments.length,r=new Array(n),s=0;s<n;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={isAuthenticated:null},e}return Object(v.a)(a,[{key:"componentDidMount",value:function(){var e=Object(h.a)(d.a.mark((function e(){return d.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,e.next=3,this.props.onTryAutoSignup();case 3:this.props.isAuthenticated?this.setState(Object(p.a)(Object(p.a)({},this.state),{},{isAuthenticated:!0})):this.setState(Object(p.a)(Object(p.a)({},this.state),{},{isAuthenticated:!1})),e.next=9;break;case 6:e.prev=6,e.t0=e.catch(0),this.setState(Object(p.a)(Object(p.a)({},this.state),{},{isAuthenticated:!1}));case 9:case"end":return e.stop()}}),e,this,[[0,6]])})));return function(){return e.apply(this,arguments)}}()},{key:"componentDidUpdate",value:function(e,t){this.props.isAuthenticated!==t.isAuthenticated&&this.setState(Object(p.a)(Object(p.a)({},this.state),{},{isAuthenticated:this.props.isAuthenticated}))}},{key:"render",value:function(){var e=null;return!1===this.state.isAuthenticated?e=r.a.createElement(y.d,null,r.a.createElement(y.b,{path:"/user/confirmation/:token",component:Z}),r.a.createElement(y.b,{path:"/log-in",component:W}),r.a.createElement(y.a,{to:"/log-in"})):null===this.state.isAuthenticated?e=null:!0===this.state.isAuthenticated&&(e=r.a.createElement(y.d,null,r.a.createElement(y.b,{path:"/",exact:!0,component:W}),r.a.createElement(y.b,{path:"/settings/users",exact:!0,component:re}),r.a.createElement(y.b,{path:"/salary-calculator",exact:!0,component:L}),r.a.createElement(y.b,{path:"/create-user",exact:!0,component:B}),r.a.createElement(y.b,{path:"/log-in",exact:!0,component:W}),r.a.createElement(y.b,{path:"/logout",exact:!0,component:X}),r.a.createElement(y.b,{path:"/user/confirmation/:token",component:Z}),r.a.createElement(y.b,{path:"/users-information",component:ee}),r.a.createElement(y.b,{component:se}))),r.a.createElement(E,null,r.a.createElement(N,{isAuthenticated:this.props.isAuthenticated,role:this.props.role}),e)}}]),a}(n.Component),le=Object(y.g)(Object(l.b)((function(e){return{isAuthenticated:null!==e.auth.token,role:e.auth.role}}),(function(e){return{onTryAutoSignup:function(){return e((function(e){var t=localStorage.getItem("token"),a=localStorage.getItem("userID"),n=localStorage.getItem("role");return null===t?(e($()),!1):(e(G(a,t,n)),!0)}))}}}))(oe)),ce=function(e,t){return Object(p.a)(Object(p.a)({},e),t)},ie={token:null,userID:null,role:null,loading:!1,error:null},ue=function(e,t){return ce(e,{error:null,loading:!0})},me=function(e,t){return ce(e,{token:t.token,userID:t.userID,error:null,loading:!1,role:t.role})},de=function(e,t){return ce(e,{error:t.error,loading:!1})},pe=function(e,t){return ce(e,{userID:null,token:null,role:null})},he=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:ie,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case"LOGIN_START":return ue(e);case"LOGIN_SUCCESS":return me(e,t);case"LOGIN_FAIL":return de(e,t);case"LOGOUT":return pe(e);default:return e}},be=Object(c.c)({auth:he}),ve=window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||c.d,ge=Object(c.e)(be,ve(Object(c.a)(u.a)));var fe=function(){return r.a.createElement(l.a,{store:ge},r.a.createElement(i.a,{basename:"/"},r.a.createElement(le,null)))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));o.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(fe,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[40,1,2]]]);
//# sourceMappingURL=main.5d529640.chunk.js.map